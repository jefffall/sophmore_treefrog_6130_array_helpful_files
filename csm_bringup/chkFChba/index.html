<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
</head>
<body>
<div style="text-align: center;"><big><span style="font-weight: bold;">Checking
the Solaris host system for Fibre Channel HBA's<br>
<br>
<small></small></span></big>
<hr style="width: 100%; height: 2px;">
<div style="text-align: left;"><big><br>
<small><small>Most storage field engineers want assurance the Fibre
Channel HBA's are in good operating order and can see attached Treefrog
Sophomore storage devices.<br>
The cfgadm command is useful to find out what is attached.<br>
<br>
</small></small></big>
<hr style="width: 100%; height: 2px;"><big><small><small><br>
</small></small></big>
<pre>Fibre Channel Fabric Device Configuration With the cfgadm Command<br><br><br>The following section describes fabric device configuration tasks with the<br>cfgadm command.<br><br>The procedures in this section use specific devices as examples to<br>illustrate how to use the cfgadm command to configure a fabric device. <br>The devices attached to fabric connected fp port is not configured <br>by default thus not available to the Solaris host. The produres in<br>this section illustrate how to configure and make fabric devices<br>available to the Solaris host.<br><br>The device information that you supply, and is displayed with the cfgadm<br>command, depends on your system configuration.<br><br>How to Display Configuration Information for all Devices<br><br>Fibre Channel fp ports c0 and c1 and the devices attached to them provide<br>examples of the type of device configuration<br>information that can be displayed with the cfgadm command.<br><br><br>Note:  <br><br>If the Fibre Channel device is not supported by the cfgadm command, it does not<br>display in the cfgadm command output.<br><br><br><br>   1.Become superuser.<br><br>   2.Display information about attachment points on the system.<br><br><br>     # cfgadm -l<br>     Ap_Id                Type         Receptacle   Occupant     Condition<br>     c0                   fc-fabric    connected    unconfigured unknown<br>     c1                   fc-private   connected    configured   unknown<br><br><br><br>     In this example, c0 represents a fabric connected fp port and c1<br>     represents a private loop connected fp port. The fabric device<br>     configuration described here is applicabel on the fabric connected<br>     fp port, c0. <br><br>   3.Display information about a system's fp ports and their attached devices. <br><br><br>     # cfgadm -al <br>     Ap_Id                Type         Receptacle   Occupant     Condition<br>     c0                   fc-fabric    connected    unconfigured unknown<br>     c0::210203708b641    disk         connected    unconfigured   unknown<br>     c0::210203708b6fb    disk         connected    unconfigured   unknown<br>     c0::210203708b9c3    disk         connected    unconfigured   unknown<br>     c0::210203708b606    disk         connected    unconfigured unknown<br>     c0::21020370fadf0    disk         connected    unconfigured unknown<br>     c0::210203708b6fb    disk         connected    unconfigured unknown<br>     c1                   fc-private   connected    configured unknown<br>     c1::220203708b69c    disk         connected    configured   unknown<br>     c1::220203708ba7d    disk         connected    configured   unknown<br>     c1::220203708b8d4    disk         connected    configured   unknown<br>     c1::220203708b9b2    disk         connected    configured   unknown<br><br><br><br>     Note:  <br><br>     The cfgadm -l commands displays information about Fibre Channel fp ports<br>     but not Fibre Channel devices.  Use the cfgadm -al<br>     command to display information about Fibre Channel devices. <br><br>     The devices attached to fabric connected fp ports are only<br>     applicable for the fabric device configuration described here.<br><br>     The configuration of private loop connected devices is handled<br>     by a Solaris host by default.<br><br><br>In the following examples, only fp attachment points are listed. The<br>attachment points displayed on your system will<br>depend on your system configuration.<br><br>How to Configure a fabric device<br><br>fabric connected fp port c0 provides an example of configuring a fabric<br>devcie attached to it.<br><br>   1.Become superuser.<br><br>   2.Identify the device to be configured.  The devices on a fabric<br>connected fp port are only eligible to be configured.  <br><br>     # cfgadm -al<br>     Ap_Id                 Type         Receptacle   Occupant     Condition<br>     c0                   fc-fabric    connected    unconfigured unknown<br>     c0::210203708b641    disk         connected    unconfigured   unknown<br>     c0::210203708b6fb    disk         connected    unconfigured   unknown<br>     c0::210203708b9c3    disk         connected    unconfigured   unknown<br>     c0::210203708b606    disk         connected    unconfigured unknown<br>     c0::21020370fadf0    disk         connected    unconfigured unknown<br>     c0::210203708b6fb    disk         connected    unconfigured unknown<br>     c1                   fc-private   connected    configured unknown<br>     c1::220203708b69c    disk         connected    configured   unknown<br>     c1::220203708ba7d    disk         connected    configured   unknown<br>     c1::220203708b8d4    disk         connected    configured   unknown<br>     c1::220203708b9b2    disk         connected    configured   unknown<br><br><br><br>   3.Configure a fabric device<br><br><br>     # cfgadm -c configure c0::210203708b641<br><br><br>   4.Verify the selected device is configured.<br><br><br>     # cfgadm -al<br>     Ap_Id                 Type         Receptacle   Occupant     Condition<br>     c0                    scsi-bus     connected    configured   unknown<br>     c0::dsk/c0t0d0        disk         connected    configured   unknown<br>     c0::rmt/0             tape         connected    configured   unknown<br>     c1                    scsi-bus     connected    unconfigured unknown<br><br>     c0                   fc-fabric    connected    configured unknown<br>     c0::210203708b641    disk         connected    configured   unknown<br>     c0::210203708b6fb    disk         connected    unconfigured   unknown<br>     c0::210203708b9c3    disk         connected    unconfigured   unknown<br>     c0::210203708b606    disk         connected    unconfigured unknown<br>     c0::21020370fadf0    disk         connected    unconfigured unknown<br>     c0::210203708b6fb    disk         connected    unconfigured unknown<br>     c1                   fc-private   connected    configured unknown<br>     c1::220203708b69c    disk         connected    configured   unknown<br>     c1::220203708ba7d    disk         connected    configured   unknown<br>     c1::220203708b8d4    disk         connected    configured   unknown<br>     c1::220203708b9b2    disk         connected    configured   unknown<br><br><br>     Notice that the Occupant column of both c0 and c0::210203708b641<br>     specifies configured, indicating that c0 port has a configured<br>     occupants and c0::210203708b641 device is configured.<br><br> 	<br>How to Unconfigure a fabric device<br><br>Fabric connected fp port c0 provides an example of unconfiguring a fabric<br>devcie attached to it.<br><br>   1.Become superuser.<br><br>   2.Identify the device to be configured.  The devices on a fabric<br>connected fp port are only eligible to be configured.  <br><br>     # cfgadm -al<br>     Ap_Id                 Type         Receptacle   Occupant     Condition<br>     c0                   fc-fabric    connected    configured unknown<br>     c0::210203708b641    disk         connected    configured   unknown<br>     c0::210203708b6fb    disk         connected    configured   unknown<br>     c0::210203708b9c3    disk         connected    configured   unknown<br>     c0::210203708b606    disk         connected    configured unknown<br>     c0::21020370fadf0    disk         connected    configured unknown<br>     c0::210203708b6fb    disk         connected    configured unknown<br>     c1                   fc-private   connected    configured unknown<br>     c1::220203708b69c    disk         connected    configured   unknown<br>     c1::220203708ba7d    disk         connected    configured   unknown<br>     c1::220203708b8d4    disk         connected    configured   unknown<br>     c1::220203708b9b2    disk         connected    configured   unknown<br><br><br><br>   3.Unconfigure a fabric device<br><br><br>     # cfgadm -c unconfigure c0::210203708b641<br><br><br>   4.Verify the selected device is configured.<br><br><br>     # cfgadm -al<br>     Ap_Id                 Type         Receptacle   Occupant     Condition<br>    c0                    scsi-bus     connected    configured   unknown<br>     c0::dsk/c0t0d0        disk         connected    configured   unknown<br>     c0::rmt/0             tape         connected    configured   unknown<br>     c1                    scsi-bus     connected    unconfigured unknown<br><br>     c0                   fc-fabric    connected    configured unknown<br>     c0::210203708b641    disk         connected    unconfigured   unknown<br>     c0::210203708b6fb    disk         connected    configured   unknown<br>     c0::210203708b9c3    disk         connected    configured   unknown<br>     c0::210203708b606    disk         connected    configured unknown<br>     c0::21020370fadf0    disk         connected    configured unknown<br>     c0::210203708b6fb    disk         connected    configured unknown<br>     c1                   fc-private   connected    configured unknown<br>     c1::220203708b69c    disk         connected    configured   unknown<br>     c1::220203708ba7d    disk         connected    configured   unknown<br>     c1::220203708b8d4    disk         connected    configured   unknown<br>     c1::220203708b9b2    disk         connected    configured   unknown<br><br><br>     Notice that the Occupant column of c0 <br>     specifies configured, indicating that c0 port has configured<br>     occupants after c0::210203708b641 device is unconfigured.<br><br> 	<br>How to Configure all unconfigured fabric devices on a fabric connected fp port <br><br>The following example provides how to confgiure all unconfigured devices on a fabric connected fp port.<br><br>   1.Become superuser.<br><br>   2.Identify a fabric connected fp port to be processed.  <br><br>     # cfgadm -al<br>     Ap_Id                 Type         Receptacle   Occupant     Condition<br>     c0                   fc-fabric    connected    unconfigured unknown<br>     c0::210203708b641    disk         connected    unconfigured   unknown<br>     c0::210203708b6fb    disk         connected    unconfigured   unknown<br>     c0::210203708b9c3    disk         connected    unconfigured   unknown<br>     c0::210203708b606    disk         connected    unconfigured unknown<br>     c0::21020370fadf0    disk         connected    unconfigured unknown<br>     c0::210203708b6fb    disk         connected    unconfigured unknown<br>     c1                   fc-private   connected    configured unknown<br>     c1::220203708b69c    disk         connected    configured   unknown<br>     c1::220203708ba7d    disk         connected    configured   unknown<br>     c1::220203708b8d4    disk         connected    configured   unknown<br>     c1::220203708b9b2    disk         connected    configured   unknown<br><br><br><br>   3.Configure all of unconfigured devices on a selcted port.<br><br><br>     # cfgadm -c configure c0<br><br>      WARNING : This operation repeats the configuration operation of an<br>      individual device for the all devices on co and may be time consuming <br>      if the number of devices on c0 is large. <br><br>   4.Verify all devices on c0 are configured.<br><br><br>     # cfgadm -al<br>     Ap_Id                 Type         Receptacle   Occupant     Condition<br>     c0                   fc-fabric    connected    configured unknown<br>     c0::210203708b641    disk         connected    configured   unknown<br>     c0::210203708b6fb    disk         connected    configured   unknown<br>     c0::210203708b9c3    disk         connected    configured   unknown<br>     c0::210203708b606    disk         connected    configured unknown<br>     c0::21020370fadf0    disk         connected    configured unknown<br>     c0::210203708b6fb    disk         connected    configured unknown<br>     c1                   fc-private   connected    configured unknown<br>     c1::220203708b69c    disk         connected    configured   unknown<br>     c1::220203708ba7d    disk         connected    configured   unknown<br>     c1::220203708b8d4    disk         connected    configured   unknown<br>     c1::220203708b9b2    disk         connected    configured   unknown<br><br><br>     Notice that the Occupant column of both c0 and all of devices under<br>     c0 specifies configured.<br>	<br><br> 	<br>How to Unconfigure all configured fabric devices on a fabric connected fp port <br><br><br>The following example provides how to unconfgiure all configured devices on a fabric connected fp port.<br><br>   1.Become superuser.<br><br>   2.Identify the device to be configured.  The devices on a fabric<br>connected fp port are only eligible to be configured.  <br><br>     # cfgadm -al<br>     Ap_Id                Type         Receptacle   Occupant     Condition<br>     c0                   fc-fabric    connected    configured unknown<br>     c0::210203708b641    disk         connected    configured   unknown<br>     c0::210203708b6fb    disk         connected    configured   unknown<br>     c0::210203708b9c3    disk         connected    configured   unknown<br>     c0::210203708b606    disk         connected    configured unknown<br>     c0::21020370fadf0    disk         connected    configured unknown<br>     c0::210203708b6fb    disk         connected    configured unknown<br>     c1                   fc-private   connected    configured unknown<br>     c1::220203708b69c    disk         connected    configured   unknown<br>     c1::220203708ba7d    disk         connected    configured   unknown<br>     c1::220203708b8d4    disk         connected    configured   unknown<br>     c1::220203708b9b2    disk         connected    configured   unknown<br><br><br><br>   3.Unconfigure all of configured devices on a selcted port.<br><br><br>     # cfgadm -c unconfigure c0<br><br>      WARNING : This operation repeats the configuration operation of an<br>      individual device for the all devices on co and may be time consuming <br>      if the number of devices on c0 is large. <br><br><br>   4.Verify all the devices on c0 are unconfigured.<br><br><br>     # cfgadm -al<br>     Ap_Id                Type         Receptacle   Occupant     Condition<br>     c0                   fc-fabric    connected    unconfigured unknown<br>     c0::210203708b641    disk         connected    unconfigured   unknown<br>     c0::210203708b6fb    disk         connected    unconfigured   unknown<br>     c0::210203708b9c3    disk         connected    unconfigured   unknown<br>     c0::210203708b606    disk         connected    unconfigured unknown<br>     c0::21020370fadf0    disk         connected    unconfigured unknown<br>     c0::210203708b6fb    disk         connected    unconfigured unknown<br>     c1                   fc-private   connected    configured unknown<br>     c1::220203708b69c    disk         connected    configured   unknown<br>     c1::220203708ba7d    disk         connected    configured   unknown<br>     c1::220203708b8d4    disk         connected    configured   unknown<br>     c1::220203708b9b2    disk         connected    configured   unknown<br><br><br>     Notice that the Occupant column of c0 and all the devices attached to<br>     it specifies unconfigured.<br><br><br>How to handle device reconfiguration when the device is configured <br>on a fabric connected fp port.<br><br>When a device is configured on a fabric connected fp port and needs to<br>reconfigured for the change like adding/removing luns of a raid storage device,<br>the device should be unconfigured from the host prior to device<br>reconfiguration and configured back after the completion of device <br>reconfiguration.<br><br>The following example provides the normal procedure for reconfiguring a device<br>when it is configured via a fabric connected fp port.<br><br>   1.Become superuser.<br><br>   2.Identify the device to be reconfigured. <br><br>     # cfgadm -al<br>     Ap_Id                Type         Receptacle   Occupant     Condition<br>     c0                   fc-fabric    connected    configured unknown<br>     c0::210203708b641    disk         connected    configured   unknown<br>     c0::210203708b6fb    disk         connected    configured   unknown<br>     c0::210203708b9c3    disk         connected    configured   unknown<br>     c0::210203708b606    disk         connected    configured unknown<br>     c0::21020370fadf0    disk         connected    configured unknown<br>     c0::210203708b6fb    disk         connected    configured unknown<br>     c1                   fc-private   connected    configured unknown<br>     c1::220203708b69c    disk         connected    configured   unknown<br>     c1::220203708ba7d    disk         connected    configured   unknown<br>     c1::220203708b8d4    disk         connected    configured   unknown<br>     c1::220203708b9b2    disk         connected    configured   unknown<br><br><br><br>   3.Unconfigure a device to be reconfigured if it is configured on a<br>     fabric connected fp port.<br><br><br>     # cfgadm -c unconfigure c0::210203708b641<br><br>   4.Verify the device is unconfigured.<br><br><br>     # cfgadm -al<br>     Ap_Id                Type         Receptacle   Occupant     Condition<br>     c0                   fc-fabric    connected    configured   unknown<br>     c0::210203708b641    disk         connected    unconfigured unknown<br>     c0::210203708b6fb    disk         connected    configured   unknown<br>     c0::210203708b9c3    disk         connected    configured   unknown<br>     c0::210203708b606    disk         connected    configured   unknown<br>     c0::21020370fadf0    disk         connected    configured   unknown<br>     c0::210203708b6fb    disk         connected    configured   unknown<br>     c1                   fc-private   connected    configured   unknown<br>     c1::220203708b69c    disk         connected    configured   unknown<br>     c1::220203708ba7d    disk         connected    configured   unknown<br>     c1::220203708b8d4    disk         connected    configured   unknown<br>     c1::220203708b9b2    disk         connected    configured   unknown<br><br> <br>   5.Do device reconfiguration such as adding additional luns or removing<br>     luns on a raid storage device.<br><br>   6.Configure the device back to the host.<br><br>     # cfgadm -c configure c0::210203708b641<br><br><br><br>SPARC: Troubleshooting Fabric Device Configuration Problems<br><br>Error Message<br><br>	cfgadm: Library error: failed to offline: device path<br><br>               Resource              Information<br>          ------------------  --------------------------<br>          /dev/dsk/c1t0d0s0   mounted filesystem "/file-system"<br><br><br>Cause<br><br>     You attempted to unconfigure a fabric device with a mounted file<br>system.<br><br>Solution<br><br>     Unmount the file system listed in the error message and try the cfgadm<br>operation again.<br><br><br>After runnng commands as above and receiving similar results, there is a good chance you could start creating filesystems manually.<br></pre>
<br>
<br>
<big><small><br>
<br>
<br>
<br>
</small><span style="font-weight: bold;"></span><span
 style="font-weight: bold;"></span></big><br>
<big><span style="font-weight: bold;"><small><small></small></small></span></big></div>
</div>
</body>
</html>
